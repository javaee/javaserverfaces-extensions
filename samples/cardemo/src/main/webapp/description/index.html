<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" >
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>DynaFaces Description</title>
<link href="style/screen.css" rel="stylesheet" type="text/css" />
</head>

<body>

<div id="nav">

	<ul class="menubar">
		<li><a href="../faces/chooseLocale.jsp">Run Demo</a></li>
		<li><a href="../javadocs/">Javadocs</a></li>
	  <li><a href="index2.html">Page 2</a></li>

	</ul>
</div>

<div id="page">
<div class="wrapper">

<div id="content">
<h3>Using DynaFaces in an Existing JSF Application</h3>

<p>This demonstration shows how DynaFaces can be used to ajaxify a part
of an existing JSF application with minimal modification to that
application, and do so in a maintainable and sensible manner.</p>

<div style="height: 20px; ">&nbsp;</div>

<h3>Background</h3>

<p>DynaFaces contains ideas from the the Avatar concept for leveraging
AJAX techniques from a JSF application.  The Avatar idea was originated
by JSF Expert Group Member <a target="_"
href="http://weblogs.java.net/blog/jhook"> Jacob Hookom</a> <a
target="_"
href="http://weblogs.java.net/blog/jhook/archive/2005/09/jsf_avatar_vs_m_1.html">
in his blog in September of 2005</a> and refined by JSF co-spec Lead <a
target="_" href="http://purl.oclc.org/NET/edburns/">Ed Burns</a> <a
target="_"
href="http://weblogs.java.net/blog/jhook/archive/2005/09/jsf_avatar_vs_m_1.html#10919">in
a comment on that blog</a>.  The Avatar idea is essentially modifying
the JSF request processing lifecycle in such a way that the lifecycle is
run only on a set of subtrees of the entire JSF View, instead of the
whole view, as shown by <font color="red">Zone 1</font> and <font
color="red">Zone 2</font> in the diagram of the carDetail page below.
</p>

<img src="images/carDetailView.jpg" />

<div style="height: 20px; ">&nbsp;</div>

<h3>Cardemo Application Structure</h3>

<p>The page flow of the existing cardemo application is shown in the
below whiteboard image.</p>

<img src="images/flow.jpg" />

<p>The user enters the application through the chooseLocale page, then
hits the storeFront, where they are presented with a list of cars to
choose from.  Chosing one takes them to the carDetail page.  Here they
can confgigure their options until they choose to buy the car.  Then
they get the confirmation page where they can either purchase the car,
or return to configure more options.  Finally, they are presented with a
customer info page where they enter their shipping information and then
they submit their order.</p>

<p>As you can see, this is the basic flow image from the standard
carstore with one extra arc added to show that the carDetail page can
lead back to itself as the user configures options.  In the existing
cardemo app, the user must press the "recalculate" button to cause their
page to refresh and the pricing options to be updated.  </p>

<h3>Using DynaFaces</h3>

<p>With DynaFaces,
two Ajax Zones are defined, as shown below.</p>

<img src="images/carDetail.jpg" />

<p>DynaFaces builds on the Avatar idea by providing a JSF component and
custom tag that lets you mark Ajax Zones in an existiting JSF page and
define how they will communicate with the JSF lifecycle on the server.
Zone 1 is an "output only" zone.  It does not cause any AJAX requests to
be initiated, but it does receive updated output from the AJAX request.
Zone 2 is an "input" zone, indicating that it contains components that
implement the <a target="_"
href="http://java.sun.com/javaee/javaserverfaces/1.2/docs/api/javax/faces/component/package-summary.html#package_description">EditableValueHolder
or ActionSource</a> interfaces of the JSF component model.  The above
declaration of Zone 2 is represented like this in JSP:
</p>

<pre><code>
&lt;jsfExt:ajaxZone id="zone2" interactionType="input" 
                inspectElementHook="inspectElement"
                eventType="onclick" eventHook="extractParams"
                action="#{carstore.currentModel.updatePricing}"&gt;

</code></pre>

<p><code>interactionType</code> element states that this zone contains
input components.</p>

<p><code>inspectElementHook</code> names a developer supplied JavaScript
function that will be called by the DynaFaces system to inspect a DOM
element within the zone and determine if that element should be
ajaxified.</p>

<p><code>eventType</code> lists the JavaScript event that should cause
this AjaxZone to "fire", causing an AJAX request to be sent to the
server.</p>

<p><code>eventHook</code> names a developer supplied JavaScript function
that is called when the JavaScript event given in the
<code>eventType</code> parameter is fired.  The function is passed a
number of parameters and is responsible for extracting the current state
of the zone so that it may be sent to the server in the AJAX
request.</p>

<p><code>action</code> is a standard JSF action MethodExpression that
will be invoked on the server side when the AJAX Zone fires, in this
case in response to any onclick on any of the elements in the zone for
which the script specified by the <code>inspectElementHook</code>
attribute returned true. </p>


</div>

</div>
</div>

<div id="footer">
<div class="wrapper">

</div>

</div>

<div style="float: left; width: 100%; height: 20px; ">&nbsp;</div>

</body>
</html>
